# üöÄ –ü–ª–∞–Ω –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ QuickBrain

**–í–µ—Ä—Å—ñ—è:** 1.0
**–î–∞—Ç–∞:** 2025-11-07
**–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è –ø–ª–∞–≥—ñ–Ω–∞:** v1.0.0

---

## üìä –ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É

### –°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏
- ‚úÖ –ú–æ–¥—É–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ –æ–∫—Ä–µ–º–∏–º–∏ –¥–≤–∏–∂–∫–∞–º–∏ (Math, Converter, DateCalc, Logic)
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ (OpenAI, Anthropic, HuggingFace, OpenRouter)
- ‚úÖ –Ü—Å—Ç–æ—Ä—ñ—è –æ–±—á–∏—Å–ª–µ–Ω—å –∑ –ø–æ—à—É–∫–æ–º —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é
- ‚úÖ –¢–µ–º–∞—Ç–∏—á–Ω—ñ —ñ–∫–æ–Ω–∫–∏ –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —Ç–µ–º–Ω–æ—ó/—Å–≤—ñ—Ç–ª–æ—ó —Ç–µ–º–∏
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
- ‚úÖ Thread-safe –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ —ñ—Å—Ç–æ—Ä—ñ—î—é (ReaderWriterLockSlim)

### –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

#### üî¥ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
1. **Main.cs –Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π** (1262 —Ä—è–¥–∫–∏) - –ø–æ—Ä—É—à–µ–Ω–Ω—è Single Responsibility Principle
2. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤** - –±–ª–æ–∫—É—î UI thread
3. **–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—Å—ñ—Ö –º–æ–¥—É–ª—ñ–≤** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è
4. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∫–µ—à—É–≤–∞–Ω–Ω—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –æ–±—á–∏—Å–ª–µ–Ω—å
5. **AI —Ç–∞–π–º–∞—É—Ç–∏** –º–æ–∂—É—Ç—å —Å–ø–æ–≤—ñ–ª—å–Ω—é–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É (2-10 —Å–µ–∫—É–Ω–¥)
6. **–ü–æ–≤—Ç–æ—Ä–Ω–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è** —ñ—Å—Ç–æ—Ä—ñ—ó –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ

#### üü° User Experience
1. **–ù–µ–º–∞—î —ñ–Ω–¥–∏–∫–∞—Ü—ñ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –¥–ª—è AI –∑–∞–ø–∏—Ç—ñ–≤
2. **–ü–æ–º–∏–ª–∫–∏ –Ω–µ –∑–∞–≤–∂–¥–∏ –∑—Ä–æ–∑—É–º—ñ–ª—ñ** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
3. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è** —Ç–∞ –ø—ñ–¥–∫–∞–∑–æ–∫
4. **–ù–µ–º–∞—î —à–≤–∏–¥–∫–∏—Ö –¥—ñ–π** –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
5. **–î—É–±–ª—ñ–∫–∞—Ç–∏ –≤ —ñ—Å—Ç–æ—Ä—ñ—ó** (–Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Å–ø—Ä–æ–±—É —ó—Ö –≤–∏–¥–∞–ª–µ–Ω–Ω—è)
6. **–ù–µ–º–∞—î –≤—ñ–∑—É–∞–ª—å–Ω–æ—ó —ñ—î—Ä–∞—Ä—Ö—ñ—ó** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

#### üü† –õ–æ–≥—ñ–∫–∞ —Ç–∞ User Flow
1. **–ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å** –º–æ–¥—É–ª—ñ–≤ (Math ‚Üí Converter ‚Üí Date ‚Üí Logic ‚Üí NLP)
2. **AI –∑–∞–ø–∏—Ç–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ** –≤—ñ–¥ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ pipeline
3. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å "smart suggestions"** –Ω–∞ –±–∞–∑—ñ —ñ—Å—Ç–æ—Ä—ñ—ó —Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
4. **–ù–µ–º–∞—î –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—ó –ø—Ä—ñ–æ—Ä–∏—Ç–∏–∑–∞—Ü—ñ—ó** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
5. **–°–∫–ª–∞–¥–Ω–∏–π –¥–æ—Å—Ç—É–ø** –¥–æ —ñ—Å—Ç–æ—Ä—ñ—ó —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

---

## üéØ –¶—ñ–ª—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø—ñ—Ö—É
- ‚ö° **–®–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**: < 50ms –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, < 200ms –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö
- üì¶ **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ**: –∑–º–µ–Ω—à–µ–Ω–Ω—è –Ω–∞ 30-40%
- üé® **UX –º–µ—Ç—Ä–∏–∫–∏**: –∑–º–µ–Ω—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–ª—ñ–∫—ñ–≤ –Ω–∞ 50%
- üìà **–¢–æ—á–Ω—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤**: 95%+ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ—Å—Ç—å –ø–µ—Ä—à–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

---

## üìã –ü–ª–∞–Ω –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

### –§–∞–∑–∞ 1: –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ üèóÔ∏è

#### 1.1 –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è Main.cs –Ω–∞ –æ–∫—Ä–µ–º—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** High
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 8-12 –≥–æ–¥–∏–Ω

**–©–æ —Ä–æ–±–∏—Ç–∏:**
```
Main.cs (1262 —Ä—è–¥–∫–∏) ‚Üí –†–æ–∑–¥—ñ–ª–∏—Ç–∏ –Ω–∞:
‚îú‚îÄ‚îÄ Main.cs (150-200 —Ä—è–¥–∫—ñ–≤) - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ QueryProcessor.cs - –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤
‚îú‚îÄ‚îÄ ResultBuilder.cs - –ø–æ–±—É–¥–æ–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
‚îú‚îÄ‚îÄ ContextMenuBuilder.cs - –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –º–µ–Ω—é
‚îú‚îÄ‚îÄ HistoryService.cs - —Å–µ—Ä–≤—ñ—Å —ñ—Å—Ç–æ—Ä—ñ—ó
‚îú‚îÄ‚îÄ IconResolver.cs - —Ä–µ–∑–æ–ª–≤–µ—Ä —ñ–∫–æ–Ω–æ–∫
‚îî‚îÄ‚îÄ SettingsManager.cs - –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –õ–µ–≥—à–µ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –æ–∫—Ä–µ–º—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
- –ö—Ä–∞—â–∞ —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–æ–¥—É
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –Ω–∞–¥ —Ä—ñ–∑–Ω–∏–º–∏ —á–∞—Å—Ç–∏–Ω–∞–º–∏
- –ó–º–µ–Ω—à–µ–Ω–Ω—è –∫–æ–≥–Ω—ñ—Ç–∏–≤–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
// Main.cs - —Ç—ñ–ª—å–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è
public class Main : IPlugin, IContextMenu, ISettingProvider
{
    private QueryProcessor _queryProcessor;
    private ResultBuilder _resultBuilder;
    private ContextMenuBuilder _menuBuilder;

    public List<Result> Query(Query query)
        => _queryProcessor.Process(query);
}

// QueryProcessor.cs - –ª–æ–≥—ñ–∫–∞ –æ–±—Ä–æ–±–∫–∏
public class QueryProcessor
{
    private readonly ModulePipeline _pipeline;
    private readonly ResultCache _cache;

    public List<Result> Process(Query query)
    {
        if (_cache.TryGet(query.Search, out var cached))
            return cached;

        var result = _pipeline.Execute(query);
        _cache.Set(query.Search, result);
        return result;
    }
}
```

---

#### 1.2 –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –º–æ–¥—É–ª—å–Ω–æ–≥–æ pipeline –∑ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-6 –≥–æ–¥–∏–Ω

**–ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞:**
```csharp
// –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –≤—Å—ñ –º–æ–¥—É–ª—ñ, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∂–µ –∑–Ω–∞–π–¥–µ–Ω–æ
var math = _mathEngine?.Evaluate(input);
var conv = _converter?.Convert(input);
var date = _dateCalc?.Calculate(input);
var logic = _logicEval?.Evaluate(input);
```

**–ù–æ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
// –ú–æ–¥—É–ª—ñ –∑ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ —Ç–∞ —Ä–∞–Ω–Ω—å–æ—é –∑—É–ø–∏–Ω–∫–æ—é
public interface ICalculationModule
{
    int Priority { get; }
    bool CanHandle(string input);
    CalculationResult? TryCalculate(string input);
}

public class ModulePipeline
{
    private readonly List<ICalculationModule> _modules;

    public ModulePipeline()
    {
        _modules = new()
        {
            new QuickMathModule { Priority = 100 },      // "2+2" - –Ω–∞–π—à–≤–∏–¥—à–µ
            new ConverterModule { Priority = 90 },       // "10 km to miles"
            new DateCalcModule { Priority = 80 },        // —Ä–æ–∑–ø—ñ–∑–Ω–∞—î –¥–∞—Ç–∏
            new LogicModule { Priority = 70 },           // –ª–æ–≥—ñ—á–Ω—ñ –≤–∏—Ä–∞–∑–∏
            new AdvancedMathModule { Priority = 60 },    // —Å–∫–ª–∞–¥–Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞
            new NLPModule { Priority = 10 }              // –æ—Å—Ç–∞–Ω–Ω—î - NLP
        };
    }

    public CalculationResult Execute(string input)
    {
        foreach (var module in _modules.OrderByDescending(m => m.Priority))
        {
            if (module.CanHandle(input))
            {
                var result = module.TryCalculate(input);
                if (result != null && !result.IsError)
                    return result;
            }
        }
        return CalculationResult.Error("Unable to process query", input);
    }
}
```

**–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–æ—Ä—è–¥–∫—É:**
1. **QuickMath** (2+2, –ø—Ä–æ—Å—Ça –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞) - 1-5ms
2. **Converter** (100 km to miles) - 5-10ms
3. **DateCalc** (today + 7 days) - 10-20ms
4. **Logic** (true AND false) - 5-10ms
5. **AdvancedMath** (sin(pi/4)) - 10-30ms
6. **NLP/AI** (—è–∫—â–æ enabled) - 100-3000ms

---

#### 1.3 Lazy initialization –º–æ–¥—É–ª—ñ–≤
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Low
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 2-3 –≥–æ–¥–∏–Ω–∏

**–ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞:**
```csharp
// –í—Å—ñ –º–æ–¥—É–ª—ñ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é—Ç—å—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
private void InitializeModules()
{
    _mathEngine = new MathEngine(_settings);
    _converter = new Converter(_settings);
    _dateCalc = new DateCalc(_settings);
    _logicEval = new LogicEval(_settings);
    _nlpProcessor = new NaturalLanguageProcessor(_settings);
    // ... —Ç–æ—â–æ
}
```

**–ù–æ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
// Lazy initialization
private Lazy<MathEngine> _mathEngine;
private Lazy<Converter> _converter;
private Lazy<DateCalc> _dateCalc;

private void InitializeModules()
{
    _mathEngine = new Lazy<MathEngine>(() => new MathEngine(_settings));
    _converter = new Lazy<Converter>(() => new Converter(_settings));
    _dateCalc = new Lazy<DateCalc>(() => new DateCalc(_settings));
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ
}

// –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
var result = _mathEngine.Value.Evaluate(input);
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –®–≤–∏–¥—à–∏–π —Å—Ç–∞—Ä—Ç –ø–ª–∞–≥—ñ–Ω–∞ (50-100ms ‚Üí 10-20ms)
- –ú–µ–Ω—à–µ –ø–∞–º'—è—Ç—ñ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
- –ú–æ–¥—É–ª—ñ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ

---

### –§–∞–∑–∞ 2: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ ‚ö°

#### 2.1 –ö–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –æ–±—á–∏—Å–ª–µ–Ω—å
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-6 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class ResultCache
{
    private readonly LruCache<string, List<Result>> _cache;
    private readonly int _maxSize = 100;

    public ResultCache(int maxSize = 100)
    {
        _cache = new LruCache<string, List<Result>>(maxSize);
    }

    public bool TryGet(string query, out List<Result> results)
    {
        var normalizedQuery = NormalizeQuery(query);
        return _cache.TryGetValue(normalizedQuery, out results);
    }

    public void Set(string query, List<Result> results)
    {
        var normalizedQuery = NormalizeQuery(query);
        _cache.AddOrUpdate(normalizedQuery, results);
    }

    private string NormalizeQuery(string query)
        => query.Trim().ToLowerInvariant();
}

// LRU Cache implementation
public class LruCache<TKey, TValue>
{
    private readonly int _capacity;
    private readonly Dictionary<TKey, LinkedListNode<CacheItem>> _cache;
    private readonly LinkedList<CacheItem> _lruList;

    // ... implementation
}
```

**–û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:**
- –ü–æ–≤—Ç–æ—Ä–Ω—ñ –∑–∞–ø–∏—Ç–∏: 50ms ‚Üí 1-2ms
- –ó–º–µ–Ω—à–µ–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ CPU –Ω–∞ 60-70%
- –ö—Ä–∞—â–∏–π UX –ø—Ä–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ –ø–æ–º–∏–ª–æ–∫

---

#### 2.2 Async/Await –¥–ª—è AI –º–æ–¥—É–ª—ñ–≤
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 5-7 –≥–æ–¥–∏–Ω

**–ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞:**
```csharp
// –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è UI thread
using var cts = new CancellationTokenSource(TimeSpan.FromMilliseconds(timeout));
var nlpTask = Task.Run(() => _nlpProcessor?.ProcessAsync(input, cts.Token), cts.Token);
if (nlpTask.Wait(Math.Min(2000, _settings.AiTimeout))) // –ë–õ–û–ö–£–í–ê–ù–ù–Ø!
{
    var nlp = nlpTask.Result;
}
```

**–ù–æ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
// Async query processing
public async Task<List<Result>> QueryAsync(Query query, CancellationToken ct = default)
{
    var results = new List<Result>();

    // –®–≤–∏–¥–∫—ñ –º–æ–¥—É–ª—ñ - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
    var quickResult = TryQuickModules(query.Search);
    if (quickResult != null)
    {
        results.Add(quickResult);
        return results;
    }

    // –ü–æ–≤—ñ–ª—å–Ω—ñ –º–æ–¥—É–ª—ñ - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑ timeout
    try
    {
        using var cts = CancellationTokenSource.CreateLinkedTokenSource(ct);
        cts.CancelAfter(TimeSpan.FromMilliseconds(_settings.AiTimeout));

        var nlpResult = await _nlpProcessor.ProcessAsync(query.Search, cts.Token);
        if (nlpResult != null && !nlpResult.IsError)
        {
            results.Add(ConvertToResult(nlpResult));
        }
    }
    catch (OperationCanceledException)
    {
        // Timeout - –ø–æ–∫–∞–∑–∞—Ç–∏ placeholder
        results.Add(CreateTimeoutResult(query.Search));
    }

    return results;
}
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ù–µ –±–ª–æ–∫—É—î—Ç—å—Å—è UI thread
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–æ–º—ñ–∂–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
- –ö—Ä–∞—â–∞ responsiveness

---

#### 2.3 –ë–∞—Ç—á–∏–Ω–≥–æ–≤–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ—Å—Ç–æ—Ä—ñ—ó
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Low
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 2-3 –≥–æ–¥–∏–Ω–∏

**–ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞:**
```csharp
// –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
public void Add(CalculationResult result)
{
    _history.Insert(0, entry);
    SaveHistory(); // –ó–∞–ø–∏—Å –Ω–∞ –¥–∏—Å–∫ –ö–û–ñ–ù–û–ì–û –†–ê–ó–£!
}
```

**–ù–æ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class HistoryManager
{
    private readonly Timer _saveTimer;
    private volatile bool _isDirty;

    public HistoryManager(Settings settings)
    {
        // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥ –∞–±–æ –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ
        _saveTimer = new Timer(SaveIfDirty, null,
            TimeSpan.FromSeconds(30),
            TimeSpan.FromSeconds(30));
    }

    public void Add(CalculationResult result)
    {
        _lock.EnterWriteLock();
        try
        {
            _history.Insert(0, entry);
            _isDirty = true; // –ü–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ –∑–º—ñ–Ω–µ–Ω–æ
        }
        finally
        {
            _lock.ExitWriteLock();
        }
    }

    private void SaveIfDirty(object? state)
    {
        if (_isDirty)
        {
            SaveHistory();
            _isDirty = false;
        }
    }

    public void Dispose()
    {
        _saveTimer?.Dispose();
        if (_isDirty) SaveHistory(); // –û—Å—Ç–∞–Ω–Ω—î –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
    }
}
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ó–º–µ–Ω—à–µ–Ω–Ω—è I/O –æ–ø–µ—Ä–∞—Ü—ñ–π –Ω–∞ 90-95%
- –®–≤–∏–¥—à–∞ —Ä–æ–±–æ—Ç–∞ –∑ —ñ—Å—Ç–æ—Ä—ñ—î—é
- –ú–µ–Ω—à–µ –∑–Ω–æ—Å—É SSD

---

#### 2.4 –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è MathEngine
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-5 –≥–æ–¥–∏–Ω

**–ü—Ä–æ–±–ª–µ–º–∏:**
1. Regex –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –±–∞–≥–∞—Ç–æ —Ä–∞–∑—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏—Ä–∞–∑—É
2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π
3. –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–π

**–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:**
```csharp
public class MathEngine
{
    // Compiled regex –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
    private static readonly Regex NumberPattern = new(@"(\d+\.?\d*|\.?\d+)",
        RegexOptions.Compiled);
    private static readonly Regex TokenPattern = new(@"(\d+\.?\d*|\.?\d+)|([+\-*/^%(),])|([a-z]+)",
        RegexOptions.Compiled);

    // Pre-computed values cache
    private readonly Dictionary<string, double> _expressionCache = new();

    public CalculationResult? Evaluate(string expression)
    {
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–µ—à—É
        if (_expressionCache.TryGetValue(expression, out var cachedResult))
        {
            return BuildResult(expression, cachedResult);
        }

        // ... –æ–±—á–∏—Å–ª–µ–Ω–Ω—è

        // –ö–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
        if (!result.IsError)
        {
            _expressionCache[expression] = result.NumericValue ?? 0;
        }

        return result;
    }

    // –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è tokenization
    private List<Token> Tokenize(string expression)
    {
        var tokens = new List<Token>(expression.Length / 2); // Pre-allocate

        foreach (Match match in TokenPattern.Matches(expression))
        {
            // ... tokenization
        }

        return tokens;
    }
}
```

---

### –§–∞–∑–∞ 3: –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è User Experience üé®

#### 3.1 –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ (Smart Suggestions)
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 6-8 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class SmartSuggestionEngine
{
    private readonly HistoryManager _history;
    private readonly Settings _settings;

    public List<Suggestion> GetSuggestions(string partialInput)
    {
        var suggestions = new List<Suggestion>();

        // 1. –Ü—Å—Ç–æ—Ä—ñ—è (–Ω–∞–π—á–∞—Å—Ç—ñ—à—ñ –∑–∞–ø–∏—Ç–∏)
        var frequentQueries = _history.GetMostFrequent(5)
            .Where(e => e.Expression.StartsWith(partialInput,
                StringComparison.OrdinalIgnoreCase));
        suggestions.AddRange(frequentQueries.Select(e => new Suggestion
        {
            Text = e.Expression,
            Type = SuggestionType.History,
            Icon = "history",
            Score = 100
        }));

        // 2. –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏
        if (partialInput.Contains("to ", StringComparison.OrdinalIgnoreCase))
        {
            suggestions.AddRange(GetConversionSuggestions(partialInput));
        }

        // 3. –§—É–Ω–∫—Ü—ñ—ó —Ç–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏
        if (partialInput.EndsWith("("))
        {
            var funcName = ExtractFunctionName(partialInput);
            suggestions.Add(GetFunctionHelp(funcName));
        }

        return suggestions.OrderByDescending(s => s.Score).ToList();
    }

    private List<Suggestion> GetConversionSuggestions(string input)
    {
        // "100 km to " ‚Üí –ø—ñ–¥–∫–∞–∑–∞—Ç–∏ "miles", "meters", "feet"
        var commonConversions = new[]
        {
            "miles", "meters", "feet", "inches",
            "pounds", "kilograms", "celsius", "fahrenheit"
        };

        return commonConversions.Select(unit => new Suggestion
        {
            Text = input + unit,
            Type = SuggestionType.Conversion,
            Icon = "convert",
            Score = 80
        }).ToList();
    }
}
```

**UX –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:**
- –ê–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω–∞ –±–∞–∑—ñ —ñ—Å—Ç–æ—Ä—ñ—ó
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ñ—É–Ω–∫—Ü—ñ–π inline

---

#### 3.2 –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Low
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 3-4 –≥–æ–¥–∏–Ω–∏

**–ü–æ—Ç–æ—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏:**
```
"Unable to process query"
"Invalid expression"
"Error"
```

**–ù–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏ –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:**
```csharp
public class ErrorMessageBuilder
{
    public static CalculationResult BuildError(Exception ex, string input)
    {
        return ex switch
        {
            DivideByZeroException => new CalculationResult
            {
                Title = "–ü–æ–º–∏–ª–∫–∞:–î—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω—É–ª—å",
                SubTitle = "–í–∏—Ä–∞–∑ –º—ñ—Å—Ç–∏—Ç—å–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω—É–ª—å. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–∞–Ω—ñ.",
                ErrorMessage = "Division by zero is undefined",
                Type = CalculationType.Error,
                IsError = true
            },

            OverflowException => new CalculationResult
            {
                Title = "–ü–æ–º–∏–ª–∫–∞: –ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è",
                SubTitle = "–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è. –°–ø—Ä–æ–±—É–π—Ç–µ –º–µ–Ω—à—ñ —á–∏—Å–ª–∞.",
                ErrorMessage = ex.Message,
                Type = CalculationType.Error,
                IsError = true
            },

            FormatException when input.Contains("to") => new CalculationResult
            {
                Title = "–ü–æ–º–∏–ª–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó",
                SubTitle = $"–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—É. –ü—Ä–∏–∫–ª–∞–¥: '100 km to miles'",
                ErrorMessage = ex.Message,
                Type = CalculationType.Error,
                IsError = true
            },

            ArgumentException => new CalculationResult
            {
                Title = "–ù–µ–≤—ñ—Ä–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å",
                SubTitle = $"–ü–æ–º–∏–ª–∫–∞: {ex.Message}. –°–ø—Ä–æ–±—É–π—Ç–µ '2+2' –∞–±–æ 'sin(45)'",
                ErrorMessage = ex.Message,
                Type = CalculationType.Error,
                IsError = true
            },

            _ => new CalculationResult
            {
                Title = "–ü–æ–º–∏–ª–∫–∞ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è",
                SubTitle = $"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ–±—Ä–æ–±–∏—Ç–∏ '{input}'. –°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à–∏–π —Ñ–æ—Ä–º–∞—Ç.",
                ErrorMessage = ex.Message,
                Type = CalculationType.Error,
                IsError = true
            }
        };
    }
}
```

---

#### 3.3 –í—ñ–∑—É–∞–ª—å–Ω–∞ —ñ–Ω–¥–∏–∫–∞—Ü—ñ—è –¥–ª—è AI –∑–∞–ø–∏—Ç—ñ–≤
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-5 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class AiProgressIndicator
{
    public Result CreateProgressResult(string query)
    {
        return new Result
        {
            Title = "ü§î –û–±—Ä–æ–±–∫–∞ AI –∑–∞–ø–∏—Ç—É...",
            SubTitle = $"–ó–∞–ø–∏—Ç: {query}",
            IcoPath = GetIconFor(CalculationType.AiAssisted),
            Score = 100,
            Action = _ =>
            {
                // –°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç
                _cancellationTokenSource?.Cancel();
                return true;
            }
        };
    }

    public Result CreateStreamingResult(string query, string partialResponse)
    {
        return new Result
        {
            Title = $"üí¨ {query}",
            SubTitle = partialResponse + " ‚ñå", // Cursor animation
            IcoPath = GetIconFor(CalculationType.AiAssisted),
            Score = 100
        };
    }
}
```

**UX –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:**
- –ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è AI
- Streaming –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π (—Ç–µ–∫—Å—Ç –∑'—è–≤–ª—è—î—Ç—å—Å—è –ø–æ—Å—Ç—É–ø–æ–≤–æ)
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç

---

#### 3.4 –®–≤–∏–¥–∫—ñ –¥—ñ—ó (Quick Actions)
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü† MEDIUM
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Low
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 2-3 –≥–æ–¥–∏–Ω–∏

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class QuickActionsBuilder
{
    public List<ContextMenuResult> BuildQuickActions(CalculationResult result)
    {
        var actions = new List<ContextMenuResult>();

        // 1. –ö–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ —á–∏—Å–ª–æ
        if (result.NumericValue.HasValue)
        {
            actions.Add(new ContextMenuResult
            {
                Title = "Copy number only (Ctrl+Shift+C)",
                AcceleratorKey = Key.C,
                AcceleratorModifiers = ModifierKeys.Control | ModifierKeys.Shift,
                Glyph = "\xE8C8",
                Action = _ =>
                {
                    Clipboard.SetText(result.NumericValue.Value.ToString());
                    return true;
                }
            });
        }

        // 2. –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –≤ —ñ–Ω—à—ñ –æ–¥–∏–Ω–∏—Ü—ñ
        if (result.Type == CalculationType.UnitConversion)
        {
            actions.Add(new ContextMenuResult
            {
                Title = "Convert to other units",
                Glyph = "\xE8AB",
                Action = _ =>
                {
                    _context.API.ChangeQuery($"qb {result.NumericValue} ", true);
                    return false;
                }
            });
        }

        // 3. –î–æ–¥–∞—Ç–∏ –¥–æ –≤–∏—Ä–∞–∑—É
        if (result.Type == CalculationType.Arithmetic)
        {
            actions.Add(new ContextMenuResult
            {
                Title = "Use in new calculation",
                Glyph = "\xE710",
                Action = _ =>
                {
                    _context.API.ChangeQuery($"qb {result.Result} + ", true);
                    return false;
                }
            });
        }

        return actions;
    }
}
```

---

#### 3.5 –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ –≤—ñ–∑—É–∞–ª—å–Ω–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü† MEDIUM
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-5 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class ResultRanker
{
    public List<Result> RankResults(List<CalculationResult> results, string query)
    {
        var rankedResults = new List<(Result result, int score)>();

        foreach (var calcResult in results)
        {
            var score = CalculateRelevanceScore(calcResult, query);
            var result = BuildResult(calcResult);
            result.Score = score;
            rankedResults.Add((result, score));
        }

        return rankedResults
            .OrderByDescending(r => r.score)
            .Select(r => r.result)
            .ToList();
    }

    private int CalculateRelevanceScore(CalculationResult result, string query)
    {
        var score = 100; // Base score

        // 1. –¢–æ—á–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å
        if (result.Type == GetExpectedType(query))
            score += 50;

        // 2. –®–≤–∏–¥–∫—ñ—Å—Ç—å –æ–±—á–∏—Å–ª–µ–Ω–Ω—è (–ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç —à–≤–∏–¥—à–∏–º)
        if (result.Type == CalculationType.Arithmetic)
            score += 30;

        // 3. –Ü—Å—Ç–æ—Ä–∏—á–Ω—ñ –¥–∞–Ω—ñ (—á–∞—Å—Ç–æ—Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)
        var historyFrequency = _history.GetFrequency(result.RawExpression);
        score += historyFrequency * 5;

        // 4. Confidence (–¥–ª—è AI)
        if (result.Type == CalculationType.AiAssisted)
            score -= 20; // AI –º–∞—î –Ω–∏–∂—á–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç

        return score;
    }

    private CalculationType GetExpectedType(string query)
    {
        if (query.Contains("to ")) return CalculationType.UnitConversion;
        if (Regex.IsMatch(query, @"\d{4}-\d{2}-\d{2}")) return CalculationType.DateCalculation;
        if (query.Contains("AND") || query.Contains("OR")) return CalculationType.LogicEvaluation;
        return CalculationType.Arithmetic;
    }
}
```

---

### –§–∞–∑–∞ 4: –õ–æ–≥—ñ—á–Ω—ñ Use Cases —Ç–∞ User Flow üîÑ

#### 4.1 –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–∏–ø—É –∑–∞–ø–∏—Ç—É
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** High
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 6-8 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class QueryClassifier
{
    private readonly Dictionary<CalculationType, List<QueryPattern>> _patterns;

    public QueryClassifier()
    {
        _patterns = new()
        {
            [CalculationType.UnitConversion] = new()
            {
                new QueryPattern(@"\d+\s*(km|kg|lb|celsius|fahrenheit)\s+to\s+", 95),
                new QueryPattern(@"convert\s+\d+", 90),
                new QueryPattern(@"\d+\s+(miles|pounds|meters)\s+in\s+", 85)
            },

            [CalculationType.DateCalculation] = new()
            {
                new QueryPattern(@"\d{4}-\d{2}-\d{2}", 95),
                new QueryPattern(@"(today|tomorrow|yesterday)", 90),
                new QueryPattern(@"(days|weeks|months|years)\s+(between|from|after)", 85)
            },

            [CalculationType.Arithmetic] = new()
            {
                new QueryPattern(@"^\d+\s*[\+\-\*/]\s*\d+$", 100),
                new QueryPattern(@"\d+%\s+of\s+\d+", 90),
                new QueryPattern(@"(sin|cos|tan|sqrt|log)\(", 95)
            },

            [CalculationType.LogicEvaluation] = new()
            {
                new QueryPattern(@"\b(true|false)\b.*\b(AND|OR|NOT|XOR)\b", 95),
                new QueryPattern(@"\d+\s*(<|>|<=|>=|==|!=)\s*\d+", 85)
            },

            [CalculationType.Health] = new()
            {
                new QueryPattern(@"bmi\s+\d+", 95),
                new QueryPattern(@"body\s+mass\s+index", 90)
            },

            [CalculationType.Money] = new()
            {
                new QueryPattern(@"tip\s+\d+%", 95),
                new QueryPattern(@"(discount|tax|interest)\s+\d+", 85)
            }
        };
    }

    public (CalculationType type, int confidence) Classify(string query)
    {
        var scores = new Dictionary<CalculationType, int>();

        foreach (var (type, patterns) in _patterns)
        {
            foreach (var pattern in patterns)
            {
                if (Regex.IsMatch(query, pattern.Pattern, RegexOptions.IgnoreCase))
                {
                    if (!scores.ContainsKey(type) || scores[type] < pattern.Confidence)
                    {
                        scores[type] = pattern.Confidence;
                    }
                }
            }
        }

        if (scores.Any())
        {
            var best = scores.OrderByDescending(s => s.Value).First();
            return (best.Key, best.Value);
        }

        return (CalculationType.Arithmetic, 0); // Default fallback
    }
}

public record QueryPattern(string Pattern, int Confidence);
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –®–≤–∏–¥—à–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–¥—É–ª—è
- –ö—Ä–∞—â–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó –Ω–∞ –±–∞–∑—ñ —ñ—Å—Ç–æ—Ä—ñ—ó

---

#### 4.2 –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–ª–µ–∂–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 5-6 –≥–æ–¥–∏–Ω

**Use Cases:**

**UC-1: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –æ–¥–∏–Ω–∏—Ü—å**
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "100 km"
–°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—É—î:
  ‚Üí 100 km to miles (62.137 miles)
  ‚Üí 100 km to meters (100,000 m)
  ‚Üí 100 km to feet (328,084 ft)
```

**UC-2: –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "sin("
–°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—É—î:
  ‚Üí sin(x) - Calculate sine of x
  ‚Üí Current angle unit: Radians
  ‚Üí Example: sin(pi/2) = 1
```

**UC-3: –î–∞—Ç–∏**
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "2025"
–°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—É—î:
  ‚Üí Days between 2025-01-01 and today
  ‚Üí Weeks until 2025-12-31
  ‚Üí Is 2025 a leap year? No
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class ContextualHintsProvider
{
    public List<Result> GetHints(string partialInput, CalculationType expectedType)
    {
        return expectedType switch
        {
            CalculationType.UnitConversion => GetConversionHints(partialInput),
            CalculationType.DateCalculation => GetDateHints(partialInput),
            CalculationType.Arithmetic => GetMathHints(partialInput),
            _ => new List<Result>()
        };
    }

    private List<Result> GetConversionHints(string input)
    {
        var hints = new List<Result>();
        var match = Regex.Match(input, @"(\d+\.?\d*)\s*([a-z]+)");

        if (match.Success)
        {
            var value = double.Parse(match.Groups[1].Value);
            var unit = match.Groups[2].Value;

            var suggestions = GetSuggestedConversions(unit);
            foreach (var targetUnit in suggestions.Take(3))
            {
                var converted = ConvertUnits(value, unit, targetUnit);
                hints.Add(new Result
                {
                    Title = $"{value} {unit} to {targetUnit}",
                    SubTitle = $"= {converted:F2} {targetUnit}",
                    Score = 90,
                    Action = _ =>
                    {
                        _context.API.ChangeQuery($"qb {value} {unit} to {targetUnit}", true);
                        return false;
                    }
                });
            }
        }

        return hints;
    }
}
```

---

#### 4.3 –Ü—Å—Ç–æ—Ä—ñ—è –∑ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 5-6 –≥–æ–¥–∏–Ω

**–ù–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:**

1. **–ß–∞—Å—Ç–æ—Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**
```csharp
public class HistoryStatistics
{
    public Dictionary<string, int> ExpressionFrequency { get; set; }
    public Dictionary<CalculationType, int> TypeFrequency { get; set; }
    public List<string> MostFrequentExpressions { get; set; }
    public TimeSpan AverageCalculationTime { get; set; }
}

public class HistoryManager
{
    public List<string> GetFrequentExpressions(int count = 5)
    {
        return _history
            .GroupBy(e => e.Expression)
            .OrderByDescending(g => g.Count())
            .Take(count)
            .Select(g => g.Key)
            .ToList();
    }

    public CalculationType GetMostUsedType()
    {
        return _history
            .GroupBy(e => e.Type)
            .OrderByDescending(g => g.Count())
            .First()
            .Key;
    }
}
```

2. **–°–º–∞—Ä—Ç-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –Ω–∞ –±–∞–∑—ñ —ñ—Å—Ç–æ—Ä—ñ—ó**
```csharp
public class SmartRecommendations
{
    public List<Result> GetRecommendations(string currentQuery)
    {
        var recommendations = new List<Result>();

        // 1. –°—Ö–æ–∂—ñ –∑–∞–ø–∏—Ç–∏ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó
        var similarQueries = _history.FindSimilar(currentQuery, 3);
        foreach (var query in similarQueries)
        {
            recommendations.Add(new Result
            {
                Title = $"üìú {query.Expression}",
                SubTitle = $"Result: {query.Result} | Used {query.UsageCount} times",
                Score = 85,
                Action = _ =>
                {
                    _context.API.ChangeQuery($"qb {query.Expression}", true);
                    return false;
                }
            });
        }

        // 2. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –Ω–∞ –±–∞–∑—ñ —Ç–∏–ø—É
        var currentType = _classifier.Classify(currentQuery).type;
        var relatedQueries = _history
            .Filter(currentType)
            .OrderByDescending(e => e.Added)
            .Take(2);

        foreach (var query in relatedQueries)
        {
            recommendations.Add(new Result
            {
                Title = $"üîç Similar: {query.Expression}",
                SubTitle = query.Result,
                Score = 75
            });
        }

        return recommendations;
    }
}
```

3. **–ï–∫—Å–ø–æ—Ä—Ç —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ —ñ—Å—Ç–æ—Ä—ñ—ó**
```csharp
public class HistoryAnalytics
{
    public HistoryReport GenerateReport()
    {
        return new HistoryReport
        {
            TotalCalculations = _history.Count,
            MostUsedType = GetMostUsedType(),
            MostUsedFunction = GetMostUsedFunction(),
            AveragePerDay = CalculateAveragePerDay(),
            TopExpressions = GetTopExpressions(10),
            TypeDistribution = GetTypeDistribution(),
            Timeline = GetUsageTimeline()
        };
    }

    private Dictionary<string, int> GetTypeDistribution()
    {
        return _history
            .GroupBy(e => e.Type.ToString())
            .ToDictionary(g => g.Key, g => g.Count());
    }

    private List<TimelinePoint> GetUsageTimeline()
    {
        return _history
            .GroupBy(e => e.Added.Date)
            .Select(g => new TimelinePoint
            {
                Date = g.Key,
                Count = g.Count(),
                Types = g.GroupBy(e => e.Type).ToDictionary(t => t.Key.ToString(), t => t.Count())
            })
            .OrderBy(p => p.Date)
            .ToList();
    }
}
```

---

#### 4.4 –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π AI workflow
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü† MEDIUM
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** High
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 8-10 –≥–æ–¥–∏–Ω

**–ü—Ä–æ–±–ª–µ–º–∏ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É:**
- AI –∑–∞–ø–∏—Ç–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ –≤—ñ–¥ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ pipeline
- –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å fallback —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó
- –ù–µ–º–∞—î –∫–æ–Ω—Ç—Ä–æ–ª—é —è–∫–æ—Å—Ç—ñ AI –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

**–ù–æ–≤–∏–π –ø—ñ–¥—Ö—ñ–¥:**
```csharp
public class AiWorkflowManager
{
    private readonly List<IAiProvider> _providers;
    private readonly QueryClassifier _classifier;
    private readonly ResultValidator _validator;

    public async Task<CalculationResult> ProcessWithAi(
        string query,
        CalculationType expectedType,
        CancellationToken ct)
    {
        // 1. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ offline —Å–ø–æ—á–∞—Ç–∫—É (—è–∫—â–æ OfflineFirst = true)
        if (_settings.OfflineFirst)
        {
            var offlineResult = TryOfflineProcessing(query, expectedType);
            if (offlineResult != null && _validator.IsValid(offlineResult, expectedType))
            {
                return offlineResult;
            }
        }

        // 2. AI processing –∑ fallback
        CalculationResult? aiResult = null;
        Exception? lastException = null;

        foreach (var provider in _providers)
        {
            try
            {
                aiResult = await provider.ProcessAsync(query, expectedType, ct);

                // –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                if (_validator.IsValid(aiResult, expectedType))
                {
                    aiResult.SubTitle += $" (via {provider.Name})";
                    return aiResult;
                }
            }
            catch (Exception ex)
            {
                lastException = ex;
                Console.WriteLine($"AI provider {provider.Name} failed: {ex.Message}");
                continue; // Try next provider
            }
        }

        // 3. Fallback –¥–æ offline —è–∫—â–æ –≤—Å—ñ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏ failed
        var fallbackResult = TryOfflineProcessing(query, expectedType);
        if (fallbackResult != null)
        {
            fallbackResult.SubTitle += " (offline fallback)";
            return fallbackResult;
        }

        // 4. –ü–æ–º–∏–ª–∫–∞
        return CalculationResult.Error(
            $"Unable to process query. {lastException?.Message ?? "No AI providers available"}",
            query);
    }
}

public class ResultValidator
{
    public bool IsValid(CalculationResult result, CalculationType expectedType)
    {
        if (result.IsError) return false;

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∏–ø—É
        if (result.Type != expectedType && expectedType != CalculationType.Error)
        {
            // –î–æ–ø—É—Å—Ç–∏–º–æ —è–∫—â–æ –±–ª–∏–∑—å–∫—ñ —Ç–∏–ø–∏
            if (!AreRelatedTypes(result.Type, expectedType))
                return false;
        }

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
        if (result.NumericValue.HasValue)
        {
            if (double.IsNaN(result.NumericValue.Value) ||
                double.IsInfinity(result.NumericValue.Value))
                return false;
        }

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø–æ—Ä–æ–∂–Ω—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if (string.IsNullOrWhiteSpace(result.Result))
            return false;

        return true;
    }

    private bool AreRelatedTypes(CalculationType actual, CalculationType expected)
    {
        var relatedGroups = new[]
        {
            new[] { CalculationType.Arithmetic, CalculationType.Algebraic, CalculationType.Trigonometric },
            new[] { CalculationType.NaturalLanguage, CalculationType.AiAssisted }
        };

        return relatedGroups.Any(group => group.Contains(actual) && group.Contains(expected));
    }
}
```

---

### –§–∞–∑–∞ 5: –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ Privacy üîí

#### 5.1 –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è API –∫–ª—é—á—ñ–≤
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-6 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class SecureSettingsManager
{
    private readonly string _settingsPath;

    public void SaveSettings(Settings settings)
    {
        var secureSettings = settings.Clone();

        // –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è API –∫–ª—é—á—ñ–≤
        secureSettings.OpenAiApiKey = EncryptApiKey(settings.OpenAiApiKey);
        secureSettings.AnthropicApiKey = EncryptApiKey(settings.AnthropicApiKey);
        secureSettings.HuggingFaceApiKey = EncryptApiKey(settings.HuggingFaceApiKey);
        secureSettings.OpenRouterApiKey = EncryptApiKey(settings.OpenRouterApiKey);

        var json = JsonSerializer.Serialize(secureSettings, new JsonSerializerOptions
        {
            WriteIndented = true
        });

        File.WriteAllText(_settingsPath, json);
    }

    private string? EncryptApiKey(string? apiKey)
    {
        if (string.IsNullOrWhiteSpace(apiKey))
            return null;

        // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Windows Data Protection API
        var bytes = Encoding.UTF8.GetBytes(apiKey);
        var encrypted = ProtectedData.Protect(
            bytes,
            entropy: null,
            scope: DataProtectionScope.CurrentUser);

        return Convert.ToBase64String(encrypted);
    }

    private string? DecryptApiKey(string? encryptedKey)
    {
        if (string.IsNullOrWhiteSpace(encryptedKey))
            return null;

        try
        {
            var encrypted = Convert.FromBase64String(encryptedKey);
            var decrypted = ProtectedData.Unprotect(
                encrypted,
                entropy: null,
                scope: DataProtectionScope.CurrentUser);

            return Encoding.UTF8.GetString(decrypted);
        }
        catch
        {
            return null; // Invalid or corrupted key
        }
    }
}
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- API –∫–ª—é—á—ñ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ plain text
- –î–æ—Å—Ç—É–ø —Ç—ñ–ª—å–∫–∏ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ Windows
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –≤–∏—Ç–æ–∫—É —á–µ—Ä–µ–∑ git/backup

---

#### 5.2 Privacy —Ä–µ–∂–∏–º –¥–ª—è —ñ—Å—Ç–æ—Ä—ñ—ó
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü† MEDIUM
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Low
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 2-3 –≥–æ–¥–∏–Ω–∏

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class Settings
{
    [JsonPropertyName("privacyMode")]
    public PrivacyMode PrivacyMode { get; set; } = PrivacyMode.Normal;

    [JsonPropertyName("excludeFromHistory")]
    public List<string> ExcludeFromHistory { get; set; } = new();
}

public enum PrivacyMode
{
    Normal,          // –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤—Å–µ
    SensitiveOnly,   // –ù–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ (–¥–∞—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, —Ñ—ñ–Ω. –¥–∞–Ω—ñ)
    NoHistory        // –í–∑–∞–≥–∞–ª—ñ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é
}

public class HistoryManager
{
    public void Add(CalculationResult result)
    {
        if (!_settings.EnableHistory || _settings.PrivacyMode == PrivacyMode.NoHistory)
            return;

        if (_settings.PrivacyMode == PrivacyMode.SensitiveOnly)
        {
            if (IsSensitiveQuery(result.RawExpression))
                return;
        }

        // Check exclude patterns
        if (_settings.ExcludeFromHistory.Any(pattern =>
            Regex.IsMatch(result.RawExpression ?? "", pattern)))
        {
            return;
        }

        // ... add to history
    }

    private bool IsSensitiveQuery(string? query)
    {
        if (string.IsNullOrWhiteSpace(query))
            return false;

        // –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ
        var sensitivePatterns = new[]
        {
            @"\b\d{4}-\d{2}-\d{2}\b",  // –î–∞—Ç–∏ (–º–æ–∂—É—Ç—å –±—É—Ç–∏ –¥–∞—Ç–∞–º–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è)
            @"\b\d{3}-\d{2}-\d{4}\b",  // SSN-like
            @"\$\d+",                   // –§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Å—É–º–∏
            @"salary|income|debt|loan", // –§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ç–µ—Ä–º—ñ–Ω–∏
        };

        return sensitivePatterns.Any(pattern =>
            Regex.IsMatch(query, pattern, RegexOptions.IgnoreCase));
    }
}
```

---

### –§–∞–∑–∞ 6: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —è–∫—ñ—Å—Ç—å üß™

#### 6.1 Unit —Ç–µ—Å—Ç–∏ –¥–ª—è –≤—Å—ñ—Ö –º–æ–¥—É–ª—ñ–≤
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** High
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 10-12 –≥–æ–¥–∏–Ω

**–ü–æ–∫—Ä–∏—Ç—Ç—è:**
- MathEngine: 100+ —Ç–µ—Å—Ç—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π
- Converter: 50+ —Ç–µ—Å—Ç—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö –æ–¥–∏–Ω–∏—Ü—å
- DateCalc: 30+ —Ç–µ—Å—Ç—ñ–≤ –¥–ª—è –¥–∞—Ç
- LogicEval: 20+ —Ç–µ—Å—Ç—ñ–≤ –¥–ª—è –ª–æ–≥—ñ–∫–∏
- HistoryManager: 25+ —Ç–µ—Å—Ç—ñ–≤
- QueryClassifier: 40+ —Ç–µ—Å—Ç—ñ–≤

**–ü—Ä–∏–∫–ª–∞–¥:**
```csharp
public class MathEngineTests
{
    [Theory]
    [InlineData("2+2", 4)]
    [InlineData("10-3", 7)]
    [InlineData("5*6", 30)]
    [InlineData("15/3", 5)]
    [InlineData("2^8", 256)]
    [InlineData("sqrt(25)", 5)]
    [InlineData("sin(0)", 0)]
    public void Evaluate_BasicOperations_ReturnsCorrectResult(string expression, double expected)
    {
        var engine = new MathEngine(new Settings());
        var result = engine.Evaluate(expression);

        Assert.NotNull(result);
        Assert.False(result.IsError);
        Assert.Equal(expected, result.NumericValue.Value, precision: 4);
    }

    [Fact]
    public void Evaluate_DivisionByZero_ReturnsError()
    {
        var engine = new MathEngine(new Settings());
        var result = engine.Evaluate("10/0");

        Assert.NotNull(result);
        Assert.True(result.IsError);
        Assert.Contains("zero", result.ErrorMessage, StringComparison.OrdinalIgnoreCase);
    }
}
```

---

#### 6.2 Performance benchmarks
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üü° HIGH
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium
**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 4-5 –≥–æ–¥–∏–Ω

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```csharp
public class PerformanceBenchmarks
{
    [Benchmark]
    public void SimpleArithmetic()
    {
        var engine = new MathEngine(_settings);
        engine.Evaluate("2+2");
    }

    [Benchmark]
    public void ComplexExpression()
    {
        var engine = new MathEngine(_settings);
        engine.Evaluate("sin(pi/4) * sqrt(2) + log10(100)");
    }

    [Benchmark]
    public void UnitConversion()
    {
        var converter = new Converter(_settings);
        converter.Convert("100 km to miles");
    }

    [Benchmark]
    public void HistorySave()
    {
        var history = new HistoryManager(_settings);
        var result = CalculationResult.Success("2+2", "4", CalculationType.Arithmetic);
        history.Add(result);
    }
}
```

**–¶—ñ–ª—å–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏:**
- SimpleArithmetic: < 1ms
- ComplexExpression: < 5ms
- UnitConversion: < 3ms
- HistorySave (batched): < 0.5ms

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø—ñ—Ö—É

### –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- ‚úÖ **–®–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:**
  - –ü—Ä–æ—Å—Ç—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è: < 50ms
  - –°–∫–ª–∞–¥–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è: < 200ms
  - AI –∑–∞–ø–∏—Ç–∏: < 3s

- ‚úÖ **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ:**
  - –ë–∞–∑–æ–≤–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è: < 50MB
  - –ó —ñ—Å—Ç–æ—Ä—ñ—î—é (100 –∑–∞–ø–∏—Å—ñ–≤): < 60MB
  - –ó–º–µ–Ω—à–µ–Ω–Ω—è –Ω–∞ 30-40% –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ø–æ—Ç–æ—á–Ω–æ—é –≤–µ—Ä—Å—ñ—î—é

- ‚úÖ **CPU –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:**
  - Idle: < 0.1%
  - Under load: < 5%

### User Experience
- ‚úÖ **–¢–æ—á–Ω—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:**
  - –ü–µ—Ä—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–π: 95%+
  - –ü–æ–º–∏–ª–∫–∏ –∑—Ä–æ–∑—É–º—ñ–ª—ñ —Ç–∞ –∫–æ—Ä–∏—Å–Ω—ñ: 100%

- ‚úÖ **–ó—Ä—É—á–Ω—ñ—Å—Ç—å:**
  - –ó–º–µ–Ω—à–µ–Ω–Ω—è –∫–ª—ñ–∫—ñ–≤ –Ω–∞ 50%
  - –ê–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î: 80%+ –≤–∏–ø–∞–¥–∫—ñ–≤
  - –ü—ñ–¥–∫–∞–∑–∫–∏ –∫–æ—Ä–∏—Å–Ω—ñ: 90%+ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å
- ‚úÖ **–¢–µ—Å—Ç–æ–≤–µ –ø–æ–∫—Ä–∏—Ç—Ç—è:** 80%+
- ‚úÖ **Crash rate:** < 0.1%
- ‚úÖ **Error recovery:** 100% (graceful degradation)

---

## üóìÔ∏è –ì—Ä–∞—Ñ—ñ–∫ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –¢–∏–∂–¥–µ–Ω—å 1-2: –§–∞–∑–∞ 1 (–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)
- –î–µ–Ω—å 1-3: –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è Main.cs
- –î–µ–Ω—å 4-5: –ú–æ–¥—É–ª—å–Ω–∏–π pipeline
- –î–µ–Ω—å 6-7: Lazy initialization + code review

### –¢–∏–∂–¥–µ–Ω—å 3-4: –§–∞–∑–∞ 2 (–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ)
- –î–µ–Ω—å 1-2: –ö–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- –î–µ–Ω—å 3-4: Async/Await –¥–ª—è AI
- –î–µ–Ω—å 5: –ë–∞—Ç—á–∏–Ω–≥–æ–≤–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
- –î–µ–Ω—å 6-7: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è MathEngine + benchmarks

### –¢–∏–∂–¥–µ–Ω—å 5-6: –§–∞–∑–∞ 3 (UX –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è)
- –î–µ–Ω—å 1-2: Smart suggestions
- –î–µ–Ω—å 3: –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏
- –î–µ–Ω—å 4-5: AI —ñ–Ω–¥–∏–∫–∞—Ü—ñ—è
- –î–µ–Ω—å 6-7: Quick actions + –≤—ñ–∑—É–∞–ª—å–Ω–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—è

### –¢–∏–∂–¥–µ–Ω—å 7-8: –§–∞–∑–∞ 4 (Use Cases —Ç–∞ Flow)
- –î–µ–Ω—å 1-3: Query classifier
- –î–µ–Ω—å 4-5: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏
- –î–µ–Ω—å 6-7: –Ü—Å—Ç–æ—Ä—ñ—è –∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏

### –¢–∏–∂–¥–µ–Ω—å 9: –§–∞–∑–∞ 5 (–ë–µ–∑–ø–µ–∫–∞)
- –î–µ–Ω—å 1-3: –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è API –∫–ª—é—á—ñ–≤
- –î–µ–Ω—å 4-5: Privacy —Ä–µ–∂–∏–º

### –¢–∏–∂–¥–µ–Ω—å 10: –§–∞–∑–∞ 6 (–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è)
- –î–µ–Ω—å 1-5: Unit —Ç–µ—Å—Ç–∏
- –î–µ–Ω—å 6-7: Integration —Ç–µ—Å—Ç–∏ —Ç–∞ benchmarks

### –¢–∏–∂–¥–µ–Ω—å 11-12: –§—ñ–Ω–∞–ª
- –î–µ–Ω—å 1-3: Bug fixes
- –î–µ–Ω—å 4-5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- –î–µ–Ω—å 6-7: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–ª—ñ–∑—É v2.0.0

---

## üéØ –ü—Ä—ñ–æ—Ä–∏—Ç–∏–∑–∞—Ü—ñ—è –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Å—Ç–∞—Ä—Ç—É

### Must Have (–≤–µ—Ä—Å—ñ—è 1.1)
1. ‚úÖ –ö–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (2.1)
2. ‚úÖ –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è Main.cs (1.1)
3. ‚úÖ Query classifier (4.1)
4. ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏ (3.2)
5. ‚úÖ Lazy initialization (1.3)

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** +50% –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, +30% UX

### Should Have (–≤–µ—Ä—Å—ñ—è 1.5)
1. ‚úÖ –ú–æ–¥—É–ª—å–Ω–∏–π pipeline (1.2)
2. ‚úÖ Smart suggestions (3.1)
3. ‚úÖ Async/Await AI (2.2)
4. ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ (4.2)
5. ‚úÖ –ë–∞—Ç—á–∏–Ω–≥–æ–≤–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è (2.3)

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** +70% –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, +60% UX

### Nice to Have (–≤–µ—Ä—Å—ñ—è 2.0)
1. ‚úÖ AI workflow improvements (4.4)
2. ‚úÖ –Ü—Å—Ç–æ—Ä—ñ—è –∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏ (4.3)
3. ‚úÖ Quick actions (3.4)
4. ‚úÖ –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è API –∫–ª—é—á—ñ–≤ (5.1)
5. ‚úÖ Privacy —Ä–µ–∂–∏–º (5.2)

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–≤–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–ª–∞–Ω—É, +100% –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, +100% UX

---

## üìä –†–∏–∑–∏–∫–∏ —Ç–∞ –º—ñ—Ç—ñ–≥–∞—Ü—ñ—è

### –¢–µ—Ö–Ω—ñ—á–Ω—ñ —Ä–∏–∑–∏–∫–∏

| –†–∏–∑–∏–∫ | –Ü–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å | –í–ø–ª–∏–≤ | –ú—ñ—Ç—ñ–≥–∞—Ü—ñ—è |
|-------|-------------|-------|-----------|
| Breaking changes –≤ API | Medium | High | Comprehensive testing, backward compatibility |
| Performance regression | Low | High | Benchmarks before/after, continuous monitoring |
| Memory leaks | Medium | Medium | Profiling, stress testing, proper disposal |
| AI provider changes | High | Medium | Abstraction layer, multiple providers support |

### –ë—ñ–∑–Ω–µ—Å —Ä–∏–∑–∏–∫–∏

| –†–∏–∑–∏–∫ | –Ü–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å | –í–ø–ª–∏–≤ | –ú—ñ—Ç—ñ–≥–∞—Ü—ñ—è |
|-------|-------------|-------|-----------|
| –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –Ω–µ –ø—Ä–∏–π–º—É—Ç—å –∑–º—ñ–Ω–∏ | Low | High | Beta testing, gradual rollout, documentation |
| –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –º—ñ–≥—Ä–∞—Ü—ñ—ó | Medium | Medium | Migration tool, backward compatibility |
| –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –∫–æ–¥—É | Medium | Low | Code reviews, documentation, tests |

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è

### –§–∞–∑–∞ 1
- [ ] Main.cs < 250 —Ä—è–¥–∫—ñ–≤
- [ ] –í—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –º–∞—é—Ç—å –æ–∫—Ä–µ–º—ñ –∫–ª–∞—Å–∏
- [ ] 100% —ñ—Å–Ω—É—é—á–∏—Ö —Ç–µ—Å—Ç—ñ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç—å
- [ ] –ú–æ–¥—É–ª—ñ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é—Ç—å—Å—è lazy

### –§–∞–∑–∞ 2
- [ ] LRU cache —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ
- [ ] Benchmarks –ø–æ–∫–∞–∑—É—é—Ç—å –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –Ω–∞ 50%+
- [ ] Async AI –Ω–µ –±–ª–æ–∫—É—î UI
- [ ] –ü–∞–º'—è—Ç—å –∑–º–µ–Ω—à–µ–Ω–∞ –Ω–∞ 30%+

### –§–∞–∑–∞ 3
- [ ] Smart suggestions –ø—Ä–∞—Ü—é—é—Ç—å –¥–ª—è 5+ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- [ ] –ü–æ–º–∏–ª–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∏
- [ ] AI —ñ–Ω–¥–∏–∫–∞—Ü—ñ—è –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –¥–ª—è –≤—Å—ñ—Ö AI –∑–∞–ø–∏—Ç—ñ–≤
- [ ] Quick actions –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–º—É –º–µ–Ω—é

### –§–∞–∑–∞ 4
- [ ] Query classifier –º–∞—î —Ç–æ—á–Ω—ñ—Å—Ç—å 90%+
- [ ] –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å –¥–ª—è –≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤
- [ ] –Ü—Å—Ç–æ—Ä—ñ—è –ø–æ–∫–∞–∑—É—î —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
- [ ] AI workflow –ø—ñ–¥—Ç—Ä–∏–º—É—î fallback

### –§–∞–∑–∞ 5
- [ ] API –∫–ª—é—á—ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ
- [ ] Privacy —Ä–µ–∂–∏–º –ø—Ä–∞—Ü—é—î
- [ ] Sensitive data –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è

### –§–∞–∑–∞ 6
- [ ] Test coverage > 80%
- [ ] –í—Å—ñ benchmarks –≤ –º–µ–∂–∞—Ö —Ü—ñ–ª—å–æ–≤–∏—Ö –º–µ—Ç—Ä–∏–∫
- [ ] Zero critical bugs
- [ ] Documentation complete

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- [PowerToys Run API](https://github.com/microsoft/PowerToys/wiki/Launcher-API)
- [.NET Performance Best Practices](https://docs.microsoft.com/en-us/dotnet/framework/performance/)
- [Async/Await Best Practices](https://docs.microsoft.com/en-us/archive/msdn-magazine/2013/march/async-await-best-practices-in-asynchronous-programming)

### –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
- BenchmarkDotNet - performance testing
- dotMemory - memory profiling
- ReSharper - code quality
- SonarQube - code analysis

---

## üéì –í–∏—Å–Ω–æ–≤–∫–∏

–¶–µ–π –ø–ª–∞–Ω –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø–æ–∫—Ä–∏–≤–∞—î –≤—Å—ñ –∞—Å–ø–µ–∫—Ç–∏ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞ QuickBrain:

1. **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –ö–µ—à—É–≤–∞–Ω–Ω—è, async –æ–ø–µ—Ä–∞—Ü—ñ—ó, lazy loading, –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤
2. **User Experience**: –ü—ñ–¥–∫–∞–∑–∫–∏, –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è, –∫—Ä–∞—â–µ UX –¥–ª—è AI, –≤—ñ–∑—É–∞–ª—å–Ω–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—è
3. **–õ–æ–≥—ñ–∫–∞**: –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤, –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π workflow, –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏
4. **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞**: –ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å, —Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ—Å—Ç—å, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ—Å—Ç—å
5. **–ë–µ–∑–ø–µ–∫–∞**: –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤, privacy —Ä–µ–∂–∏–º

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚ö° **2x-10x —à–≤–∏–¥—à–µ** –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π
- üé® **–ó–Ω–∞—á–Ω–æ –∫—Ä–∞—â–µ UX** –∑ –ø—ñ–¥–∫–∞–∑–∫–∞–º–∏ —Ç–∞ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è–º
- üèóÔ∏è **–ë—ñ–ª—å—à –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏–π –∫–æ–¥** –∑ —á—ñ—Ç–∫–æ—é –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–æ—é
- üîí **–ë–µ–∑–ø–µ—á–Ω—ñ—à–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è** —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö

**–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫:** –û–±—Ä–∞—Ç–∏ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω—ñ –∑–∞–¥–∞—á—ñ —Ç–∞ –ø–æ—á–∞—Ç–∏ –∑ –§–∞–∑–∏ 1!
